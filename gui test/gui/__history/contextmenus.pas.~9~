unit contextmenus;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, Addresses;

type
  TContextMenu = class
  private

  public
    function getSize(): TRect;
    function isMenu(): boolean;
    function itemIndex( name: string ): integer;
  end;

implementation

uses
  unit1;

function TContextMenu.getSize(): TRect;
var
  addr: integer;
begin
  addr := Memory.ReadInteger( addresses.dialogPointer );

  result.Left := Memory.ReadInteger( addr + $14 );
  result.Top := Memory.ReadInteger( addr + $18 );
  result.Right := Memory.ReadInteger( addr + $1C );
  result.Bottom := Memory.ReadInteger( addr + $20 );
end;

function TContextMenu.isMenu(): boolean;
begin
  result := (Memory.ReadPointer( Addresses.dialogPointer, [ $40 ] ) = 0);
end;

function TContextMenu.itemIndex( name: string ): integer;
var
  addr, i: integer;
  str: string;
begin
  result := -1;
  i := 0;
  addr := Memory.ReadPointer( Addresses.dialogPointer, [ $24 ] );
  while addr <> 0 do
  begin
    str := Memory.ReadString( addr + Addresses.contextMenuItemName );

    showmessage(str);

    addr := Memory.ReadInteger( addr + $10 );
  end;
end;

end.
